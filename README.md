# 数学雷电

基于Phaser.js框架开发的数学教育射击游戏，通过游戏化的方式提升数学技能。玩家在激烈的射击战斗中拾取道具，通过解答数学题获得强力奖励。支持桌面端和移动端，提供完整的跨平台游戏体验。

## 项目特色

- 🚀 **激烈的射击战斗体验** - 完整的飞机射击游戏机制
- 🧮 **智能数学题系统** - 根据难度等级动态生成数学题
- ⚡ **多样化武器系统** - 3级武器升级，从单发到三发散射
- 🎯 **主动选择做题时机** - 拾取道具触发数学题，策略性更强
- 🛡️ **完整的防护系统** - 护盾、生命值、无敌时间机制
- 🎮 **现代化UI界面** - 实时HUD显示，美观的游戏界面
- 📱 **完整移动端支持** - 虚拟摇杆、触屏控制、响应式布局
- 🎯 **跨平台兼容** - 桌面端键盘控制，移动端触控操作

## 技术栈

- **Phaser 3.90+**: 游戏引擎
- **ES6 模块化**: 现代JavaScript语法
- **Vite 6.3+**: 快速构建工具
- **Arcade Physics**: 物理引擎
- **动态纹理生成**: 无需外部图片资源
- **响应式设计**: 自适应不同屏幕尺寸

## 项目结构

```
math_raiden/
├── src/
│   ├── main.js              # 游戏入口和配置
│   ├── scenes/              # 游戏场景
│   │   ├── BootScene.js     # 启动场景
│   │   ├── PreloadScene.js  # 预加载场景
│   │   ├── MenuScene.js     # 主菜单场景
│   │   ├── GameScene.js     # 主游戏场景
│   │   ├── GameOverScene.js # 游戏结束场景
│   │   └── MathQuestionScene.js # 数学题场景
│   ├── objects/             # 游戏对象
│   │   ├── Player.js        # 玩家飞机
│   │   ├── Enemy.js         # 敌机系统
│   │   ├── Bullet.js        # 子弹管理器
│   │   └── Missile.js       # 追踪导弹
│   ├── systems/             # 游戏系统
│   │   ├── MathSystem.js    # 数学题生成系统
│   │   └── EffectSystem.js  # 特效系统
│   ├── ui/                  # UI组件
│   │   ├── HUD.js           # 游戏界面HUD
│   │   ├── TouchControls.js # 触控系统
│   │   ├── TouchKeyboard.js # 虚拟键盘
│   │   └── TouchPauseButton.js # 触控暂停按钮
│   ├── managers/            # 管理器
│   │   └── MissileManager.js # 导弹管理器
│   └── utils/               # 工具类
│       └── Constants.js     # 游戏常量配置
├── assets/                  # 游戏资源
│   ├── images/              # 图片资源
│   └── audio/               # 音频资源
├── index.html              # 游戏入口页面
├── vite.config.js          # Vite配置
├── package.json            # 项目配置
├── demo.html               # 完整游戏演示
├── architecture-design.md  # 架构设计文档
├── check-project.js        # 项目检查工具
└── README.md               # 项目说明文档
```

## 核心功能实现

### ✅ 已完成的核心系统

#### 🎮 游戏场景系统
- **完整的6个游戏场景**，流畅的场景切换
- **启动序列**: Boot → Preload → Menu → Game
- **游戏循环**: Game ↔ MathQuestion → GameOver → Menu

#### 🚀 玩家系统 (Player.js)
- **多级武器系统**: 单发 → 双发 → 三发散射
- **防护机制**: 生命值(最大5)、护盾(最大25)、无敌时间
- **移动控制**: 方向键/WASD，平滑移动和阻力
- **自动射击**: 根据武器等级自动发射不同模式子弹
- **导弹系统**: 追踪导弹，最大100发
- **跨平台控制**: 支持键盘和触控输入

#### 👾 敌机系统 (Enemy.js)
- **多种敌机类型**: 不同血量、速度、分数值
- **智能AI**: 自动射击、移动模式
- **随机生成**: 定时生成，位置随机
- **碰撞检测**: 完整的伤害和摧毁逻辑

#### 💥 子弹系统 (Bullet.js)
- **双向子弹**: 玩家子弹和敌机子弹分离管理
- **对象池**: 高效的子弹复用机制
- **多种弹道**: 直线、散射、追踪
- **伤害系统**: 不同子弹造成不同伤害

#### 🧮 数学题系统 (MathSystem.js)
- **三个难度等级**:
  - G1: 10以内加减法
  - G2: 20以内加减法  
  - G3: 乘法运算
- **智能题目生成**: 确保结果为正数
- **奖励机制**: 答对获得完整奖励，答错获得保护时间
- **统计功能**: 答题准确率、总题数统计
- **实时难度切换**: 游戏中按1/2/3键切换

#### 🎨 特效系统 (EffectSystem.js)
- **爆炸特效**: 敌机摧毁、玩家死亡
- **武器特效**: 枪口火花、子弹轨迹
- **道具特效**: 拾取光效、升级特效
- **护盾特效**: 护盾显示、受击反馈

#### 🖥️ UI系统 (HUD.js)
- **实时状态显示**: 生命、护盾、武器等级、导弹数
- **分数系统**: 实时分数、击败敌机数
- **消息系统**: 道具获得、状态变化提示
- **暂停功能**: P键暂停，ESC返回菜单
- **响应式布局**: 自适应不同屏幕尺寸

#### 📱 移动端支持系统
- **TouchControls.js**: 完整的触控系统
  - 虚拟摇杆控制
  - 全屏触控模式
  - 实时模式切换
  - 响应式布局适配
- **TouchKeyboard.js**: 虚拟数字键盘
  - 数学题答题专用
  - 触控友好设计
  - 动态显示隐藏
- **TouchPauseButton.js**: 触控暂停按钮
  - 移动端专用暂停控制
  - 视觉反馈效果

#### ⚙️ 配置系统 (Constants.js)
- **游戏平衡**: 完整的数值配置
- **道具配置**: 6种道具类型和效果
- **物理参数**: 速度、伤害、生命值等
- **数学题配置**: 难度等级和奖励设置

### 🎯 道具系统
游戏包含6种道具，拾取后触发数学题：

1. **🔫 WEAPON** - 武器升级 (绿色)
2. **🛡️ SHIELD** - 护盾恢复 (青色)  
3. **❤️ LIFE** - 生命恢复 (紫色)
4. **💣 BOMB** - 清屏炸弹 (红色)
5. **🚀 MISSILE** - 导弹补给 (绿色)
6. **⭐ SCORE** - 分数奖励 (金色)

### 🎮 操作控制

#### 桌面端控制
- **移动**: 方向键 或 WASD
- **射击**: 自动射击
- **导弹**: 自动发射(需要导弹数量)
- **暂停**: P键
- **返回菜单**: ESC键
- **切换难度**: 1/2/3数字键

#### 移动端控制
- **移动**: 虚拟摇杆 或 触屏拖拽
- **控制模式切换**: 左上角按钮
- **暂停**: 右上角暂停按钮
- **数学题答题**: 虚拟数字键盘
- **自动射击**: 无需手动操作

## 开发进度

### ✅ 已完成 (100%核心功能)
- [x] 项目基础架构搭建
- [x] Vite构建配置和ES6模块化
- [x] 完整的6个游戏场景
- [x] 玩家飞机系统(移动、射击、武器升级)
- [x] 敌机系统(AI、生成、多类型)
- [x] 子弹系统(双向、对象池、碰撞)
- [x] 导弹系统(追踪、爆炸、范围伤害)
- [x] 数学题生成系统(3个难度等级)
- [x] 道具系统(6种道具类型)
- [x] 特效系统(爆炸、光效、粒子)
- [x] HUD界面系统(状态显示、消息)
- [x] 游戏状态管理(分数、生命、统计)
- [x] 碰撞检测系统
- [x] 动态纹理生成
- [x] 游戏平衡调试
- [x] **完整移动端支持**
- [x] **虚拟摇杆系统**
- [x] **触屏控制系统**
- [x] **虚拟键盘系统**
- [x] **响应式布局设计**
- [x] **跨平台兼容性**
- [x] **导弹管理器系统**
- [x] **项目检查工具**
- [x] **架构设计文档**
- [x] **完整游戏演示**

### 🚧 待优化
- [ ] 音效系统集成
- [ ] 性能优化(特别是移动端)
- [ ] 更多视觉特效
- [ ] 代码重构和优化

### 📋 未来计划
- [ ] 更多敌机类型和Boss战
- [ ] 成就系统和排行榜
- [ ] 本地存储和进度保存
- [ ] 更多数学题类型(分数、小数、几何)
- [ ] 多人对战模式
- [ ] 关卡编辑器
- [ ] 更多道具类型
- [ ] 难度自适应系统

## 快速开始

### 环境要求
- Node.js 16+
- 现代浏览器(支持ES6模块)

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```
访问 http://localhost:3000 开始游戏

### 构建生产版本
```bash
npm run build
```

### 预览构建结果
```bash
npm run preview
```

### 检查项目状态
```bash
node check-project.js
```
这个工具会自动检查：
- 文件完整性
- 目录结构
- 依赖安装状态
- 代码统计
- 功能完成度

## 游戏玩法详解

### 基础玩法
1. **选择难度**: 主菜单选择G1/G2/G3难度等级
2. **控制飞机**: 
   - 桌面端：方向键或WASD控制移动
   - 移动端：虚拟摇杆或触屏拖拽
3. **自动战斗**: 飞机自动射击，消灭敌机获得分数
4. **拾取道具**: 触碰道具触发数学题挑战
5. **解答题目**: 
   - ✅ **答对**: 获得完整道具效果 + 分数奖励 + 无敌时间
   - ❌ **答错**: 获得1秒保护时间(人性化设计)

### 移动端特色功能
- **双控制模式**: 摇杆模式和触屏模式随时切换
- **虚拟键盘**: 专为数学题答题设计的触控键盘
- **响应式界面**: 自动适配不同屏幕尺寸
- **触控优化**: 合理的触控热区和视觉反馈

### 进阶策略
- **时机选择**: 在安全时刻拾取道具，避免答题时被攻击
- **难度切换**: 游戏中按1/2/3键切换数学难度
- **资源管理**: 合理使用导弹清理密集敌群
- **生存优先**: 优先拾取生命和护盾道具

### 评分系统
- 击败敌机: 10-50分(根据敌机类型)
- 答对题目: 额外50分奖励
- 道具奖励: 200-500分(根据道具类型)
- 生存时间: 持续游戏获得时间奖励

## 技术亮点

### 🏗️ 架构设计
- **模块化设计**: ES6模块，清晰的职责分离
- **面向对象**: 完整的类继承体系
- **事件驱动**: 基于Phaser事件系统的松耦合设计
- **跨平台架构**: 统一的输入处理和响应式设计

### ⚡ 性能优化
- **对象池**: 子弹复用，减少GC压力
- **动态纹理**: 运行时生成，无需外部资源
- **智能更新**: 只更新活跃对象
- **响应式渲染**: 根据设备性能调整渲染质量

### 🎮 游戏体验
- **平滑操作**: 阻力系统和速度补偿
- **视觉反馈**: 丰富的特效和动画
- **触控优化**: 专为移动端设计的交互体验
- **无缝切换**: 桌面端和移动端的统一体验

### 📊 代码质量
- **总代码量**: 5600+ 行
- **文件组织**: 19个核心JS文件
- **注释覆盖**: 详细的中文注释
- **错误处理**: 完善的异常捕获
- **模块化程度**: 高内聚低耦合的设计
- **项目工具**: 自动化项目检查脚本
- **文档完整**: 架构设计文档和使用说明

## 项目统计

### 📈 代码规模
- **JavaScript文件**: 19个
- **总代码行数**: 5605行
- **核心场景**: 6个
- **游戏对象**: 4个
- **系统模块**: 2个
- **UI组件**: 4个
- **管理器**: 1个
- **工具类**: 1个
- **入口文件**: 1个

### 🎯 功能完成度
- **核心游戏功能**: 100% ✅
- **移动端支持**: 100% ✅
- **数学题系统**: 100% ✅
- **特效系统**: 100% ✅
- **武器系统**: 100% ✅
- **UI系统**: 100% ✅
- **导弹系统**: 100% ✅
- **触控系统**: 100% ✅

### 📊 模块详情
- **游戏场景系统**: 1085行 (核心游戏逻辑)
- **玩家系统**: 565行 (移动、射击、升级)
- **敌机系统**: 227行 (AI、生成、攻击)
- **子弹系统**: 262行 (对象池、碰撞检测)
- **导弹系统**: 255行 + 59行管理器 (追踪、爆炸)
- **数学题系统**: 258行 (题目生成、难度管理)
- **特效系统**: 448行 (爆炸、粒子、光效)
- **HUD界面**: 406行 (状态显示、消息系统)
- **移动端触控**: 734行 (虚拟摇杆、触屏控制)
- **虚拟键盘**: 314行 (数学题答题专用)

## 贡献指南

欢迎提交Issue和Pull Request来改进游戏！

### 开发规范
- 使用ES6+语法
- 遵循模块化设计原则
- 添加详细的中文注释
- 提交信息使用CC规范

### 测试建议
1. 运行 `node check-project.js` 检查项目完整性
2. 测试所有难度等级的数学题生成
3. 验证道具效果和游戏平衡性
4. 检查桌面端和移动端兼容性
5. 测试触控系统和虚拟键盘响应
6. 验证导弹追踪和爆炸效果
7. 检查特效系统性能影响

## 许可证

MIT License

## 更新日志

### v1.0.0 (2024-12)
- 🎉 项目正式完成，所有核心功能开发完毕
- ✅ 完整的游戏场景系统(6个场景)
- ✅ 玩家系统、敌机系统、武器系统
- ✅ 数学题系统(3个难度等级)
- ✅ 完整的移动端支持
- ✅ 触控系统和虚拟键盘
- ✅ 导弹系统和特效系统
- ✅ 项目检查工具和完整文档
- 📊 总代码量达到5600+行

---

**🎮 立即开始游戏**: `npm run dev` 然后访问 http://localhost:3000

**📖 查看完整演示**: 打开 `demo.html` 文件体验完整游戏

**📱 移动端体验**: 在手机浏览器中访问游戏，体验完整的触控操作

**🔧 检查项目状态**: 运行 `node check-project.js` 查看项目完整性 